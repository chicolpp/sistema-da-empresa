<!-- Scaffolding generated by Casein v5.1.1.1 -->

<h2>Instalação</h2>

<%= f.hidden_field :poco_id, value: params[:poco] if params[:poco].present? %>
<%= f.hidden_field :poco_id, value: @instalacao.poco_id if @instalacao.poco_id.to_i > 0 %>
<div class="row">
	<div class="col-lg-12">
		<div class="input-group">
		  <span class="input-group-addon" id="addon-poco-id">Poço *</span>

			<% if params[:poco].present? || @instalacao.poco_id.to_i > 0 %>
				<% disabled = true %>
			<% else %>
				<% disabled = false %>
			<% end %>

			<%= f.collection_select :poco_id, Poco.select("pocos.id, CONCAT(pessoas.nome, '-', pocos.linha_endereco, '-', pocos.apelido_endereco) as nome").joins(cliente: [:pessoa]).order("CONCAT(pessoas.nome, '-', pocos.linha_endereco, '-', pocos.apelido_endereco)").all, :id, :nome, {include_blank: true, selected: @instalacao.poco_id || params[:poco]}, {class: "form-control #{f.object.errors[:poco_id].first ? 'input-error' : ''} select_padrao", "aria-describedby" => "addon-poco-id", disabled: disabled} %>
		</div>
	</div>
</div>

<div class="row">
	<div class="col-lg-3">
		<div class="input-group">
		  <span class="input-group-addon" id="addon-possui-instalacao">Possui Instalação? *</span>
			<%= f.select :possui_instalacao, [["Sim", true], ["Não", false]], {}, {class: "checkbox_possui_instalacao form-control #{f.object.errors[:possui_instalacao].first ? 'input-error' : ''}", "aria-describedby" => "addon-possui-instalacao"} %>
		</div>
	</div>
  <div class="col-lg-4">
		<div class="input-group">
		  <span class="input-group-addon" id="addon-periodo-manutencao">Período de Manutenção</span>
			<%= f.select :periodo_manutencao, [["A cada 1 ano", 1], ["A cada 2 anos", 2], ["A cada 3 anos", 3], ["A cada 4 anos", 4], ["A cada 5 anos", 5]], {include_blank: true}, {class: "form-control #{f.object.errors[:periodo_manutencao].first ? 'input-error' : ''}", "aria-describedby" => "addon-periodo-manutencao"} %>
		</div>
	</div>
  <div class="col-lg-4">
		<div class="input-group">
		  <span class="input-group-addon" id="addon-periodo-manutencao">Data da Instalação</span>
			<% f.object.data_instalacao_inicio = f.object.data_instalacao_inicio.strftime('%d/%m/%Y') unless f.object.data_instalacao_inicio.blank? %>
			<%= f.text_field :data_instalacao_inicio, class: "form-control #{f.object.errors[:data_instalacao_inicio].first ? 'input-error' : ''}", "aria-describedby" => "addon-data-perfuracao-inicio", data: {masker: true, type: :d} %>
		</div>
	</div>
</div>

<div id="conteudo">
	<div class="row">
		<div class="col-lg-4">
			<h2>Informações sobre o Poço</h2>
			<div class="input-group">
			  <span class="input-group-addon" id="addon-acesso-poco">Acesso ao poço *</span>
				<%= f.select :acesso, [["Ótimo", 0], ["Bom", 1], ["Satisfatório", 2], ["Ruim", 3], ["Péssimo", 4]], {include_blank: true}, {class: "form-control #{f.object.errors[:acesso].first ? 'input-error' : ''}", "aria-describedby" => "addon-acesso-poco"} %>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-lg-4">
			<div class="input-group">
			  <span class="input-group-addon" id="addon-guincho">Necessita de Guincho Manual? *</span>
				<%= f.select :guincho, [["Sim", true], ["Não", false]], {include_blank: true}, {class: "form-control #{f.object.errors[:guincho].first ? 'input-error' : ''}", "aria-describedby" => "addon-guincho"} %>
			</div>
		</div>
		<div class="col-lg-4">
			<div class="input-group">
			  <span class="input-group-addon" id="addon-profundidade-bomba">Profundidade da Bomba *</span>
				<%= f.text_field :profundidade_bomba, class: "form-control #{f.object.errors[:profundidade_bomba].first ? 'input-error' : ''} masc-decimal", "aria-describedby" => "addon-profundidade-bomba" %>
			</div>
		</div>
		<div class="col-lg-4">
			<div class="input-group">
			  <span class="input-group-addon" id="addon-vazao-bomba">Vazão da Bomba *</span>
				<%= f.text_field :vazao_bomba, class: "form-control #{f.object.errors[:vazao_bomba].first ? 'input-error' : ''} masc-decimal", "aria-describedby" => "addon-vazao-bomba" %>
			</div>
		</div>
		<div class="col-lg-4">
			<div class="input-group">
			  <span class="input-group-addon" id="addon-nivel-dinamico">Nível Dinâmico</span>
				<%= f.text_field :nivel_dinamico, class: "form-control #{f.object.errors[:nivel_dinamico].first ? 'input-error' : ''} masc-decimal", "aria-describedby" => "addon-nivel-dinamico" %>
			</div>
		</div>
		<div class="col-lg-4">
			<div class="input-group">
			  <span class="input-group-addon" id="addon-nivel-estatico">Nível Estático</span>
				<%= f.text_field :nivel_estatico, class: "form-control #{f.object.errors[:nivel_estatico].first ? 'input-error' : ''} masc-decimal", "aria-describedby" => "addon-nivel-estatico" %>
			</div>
		</div>
		<div class="col-lg-4">
			<div class="input-group">
			  <span class="input-group-addon" id="addon-perca-carga">Perca de Carga</span>
				<%= f.text_field :perca_carga, class: "form-control #{f.object.errors[:perca_carga].first ? 'input-error' : ''} masc-decimal", "aria-describedby" => "addon-perca-carga" %>
			</div>
		</div>
		<div class="col-lg-4">
			<div class="input-group">
			  <span class="input-group-addon" id="addon-desnivel">Desnível</span>
				<%= f.text_field :desnivel, class: "form-control #{f.object.errors[:desnivel].first ? 'input-error' : ''} masc-decimal", "aria-describedby" => "addon-desnivel" %>
			</div>
		</div>
		<div class="col-lg-4">
			<div class="input-group">
			  <span class="input-group-addon" id="addon-altura-nanometrica">Altura Manométrica</span>
				<%= f.text_field :altura_nanometrica, class: "form-control #{f.object.errors[:altura_nanometrica].first ? 'input-error' : ''} masc-decimal", "aria-describedby" => "addon-altura-nanometrica" %>
			</div>
		</div>
		<div class="col-lg-4">
			<div class="input-group">
			  <span class="input-group-addon" id="addon-distancia-poco-caixa">Distância do poço até a caixa</span>
				<%= f.text_field :distancia_poco_caixa, class: "form-control #{f.object.errors[:distancia_poco_caixa].first ? 'input-error' : ''} masc-decimal", "aria-describedby" => "addon-distancia-poco-caixa" %>
			</div>
		</div>

		<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
			<div id="dados_instalacao_funcionarios">
				<div class="row">
					<div class="col-lg-12">
						<h2>
							Equipe de Instalação
							<%= link_to_add_fields "#{casein_show_icon "plus-sign"}Incluir Funcionário".html_safe, f, :instalacao_funcionarios, "pull-right", "Adicionar um Novo Funcionário", "instalacao_funcionarios" %>
						</h2>
					</div>
				</div>
				<div id="instalacao_funcionarios">
					<%= f.fields_for :instalacao_funcionarios do |instalacao_funcionario|%>
					  <%= render "casein/instalacao_funcionarios/form", f: instalacao_funcionario %>
					<% end %>
				</div>
			</div>
		</div>

		<div class="col-lg-12">
			<h2>Conjunto Moto-Bomba</h2>
			<%= f.fields_for :bomba, @instalacao.bomba do |bomba|%>
				<%= render "casein/bombas/form", f: bomba %>
			<% end %>
		</div>
	</div>

	<div class="row">
		<div id="dados_instalacao_poco_equipamentos">
			<div class="col-lg-12">
				<h2>
					Equipamentos Utilizados na Instalação do Poço
					<%= link_to_add_fields "#{casein_show_icon "plus-sign"}Incluir Equipamento".html_safe, f, :instalacao_poco_equipamentos, "pull-right", "Adicionar um Novo Equipamento", "instalacao_poco_equipamentos" %>
				</h2>
			</div>
			<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
				<div id="instalacao_poco_equipamentos">
					<%= f.fields_for :instalacao_poco_equipamentos do |instalacao_poco_equipamento| %>
						<%= render "casein/instalacao_poco_equipamentos/form", f: instalacao_poco_equipamento %>
					<% end %>
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div id="dados_instalacao_adutora_equipamentos">
			<div class="col-lg-12">
				<h2>
					Equipamentos Utilizados na Instalação da Rede Adutora
					<%= link_to_add_fields "#{casein_show_icon "plus-sign"}Incluir Equipamento".html_safe, f, :instalacao_adutora_equipamentos, "pull-right", "Adicionar um Novo Equipamento", "instalacao_adutora_equipamentos" %>
				</h2>
			</div>
			<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
				<div id="instalacao_adutora_equipamentos">
					<%= f.fields_for :instalacao_adutora_equipamentos do |instalacao_adutora_equipamento| %>
						<%= render "casein/instalacao_adutora_equipamentos/form", f: instalacao_adutora_equipamento %>
					<% end %>
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div id="dados_instalacao_distribuicao_equipamentos">
			<div class="col-lg-12">
				<h2>
					Equipamentos Utilizados na Instalação da Rede de Distribuição
					<%= link_to_add_fields "#{casein_show_icon "plus-sign"}Incluir Equipamento".html_safe, f, :instalacao_distribuicao_equipamentos, "pull-right", "Adicionar um Novo Equipamento", "instalacao_distribuicao_equipamentos" %>
				</h2>
			</div>
			<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
				<div id="instalacao_distribuicao_equipamentos">
					<%= f.fields_for :instalacao_distribuicao_equipamentos do |instalacao_distribuicao_equipamento| %>
						<%= render "casein/instalacao_distribuicao_equipamentos/form", f: instalacao_distribuicao_equipamento %>
					<% end %>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="row">
	<div id="dados_arquivos">
		<div class="col-lg-12">
			<h2>
				Adicionar Fotos/Documentos
				<%= link_to_add_fields "#{casein_show_icon "plus-sign"}Incluir Arquivo".html_safe, f, :arquivos, "pull-right", "Adicionar um Novo Arquivo", "arquivos" %>
			</h2>
		</div>
		<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
			<div id="arquivos">
				<%= f.fields_for :arquivos do |arquivo|%>
				  <%= render "casein/arquivos/form", f: arquivo %>
				<% end %>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript">
	jQuery(document).ready(function($) {
		if ($(".checkbox_possui_instalacao").val() == "true"){
			$("#conteudo").show();
		} else {
			$("#conteudo").hide();
		}
	});
  	
  	$(".checkbox_possui_instalacao").change(function(){
		if ($(this).val() == "true"){
			$("#conteudo").show();
		} else {
			$("#conteudo").hide();
		}
	});

	// A Altura manométrica é igual a Desnível+Perca de Carga+Nível Dinâmico
	// $("#instalacao_nivel_dinamico, #instalacao_perca_carga, #instalacao_desnivel").on('keyup', function() {
	// 	var nivelDinamico = parseFloat($("#instalacao_nivel_dinamico").val().replace(',', '.'));
	// 	var nivelPercaCarga = parseFloat($("#instalacao_perca_carga").val().replace(',', '.'));
	// 	var nivelDesnivel = parseFloat($("#instalacao_desnivel").val().replace(',', '.'));

	// 	var total = parseFloat(0);

	// 	if (nivelDinamico > 0) {
	// 		total += nivelDinamico;
	// 	}

	// 	if (nivelPercaCarga > 0) {
	// 		total += nivelPercaCarga;
	// 	}

	// 	if (nivelDesnivel > 0) {
	// 		total += nivelDesnivel;
	// 	}

	// 	$("#instalacao_altura_nanometrica").val(total.toString().replace('.', ','));
	// });
</script>