<legend>Filtros</legend>

<div class="form-group">
	<%= label_tag :nome, "Nome", class: "control-label" %>
	<%= text_field_tag :nome, params[:nome], class: "form-control", autofocus: true %>
</div>

<button type="button" id="botao-filtrar" class="btn btn-primary" data-toggle="modal" data-target="#filtro">
  Filtrar
</button>

<!-- Modal -->
<div class="modal fade" id="filtro" tabindex="-1" role="dialog" aria-labelledby="filtroLabel">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="filtroLabel">Filtro por Pessoas</h4>
      </div>
      <div class="modal-body">
      	<div class="tabela">
	      	<% @pessoas = Pessoa.all %>
		      <%= render partial: "table", locals: { pessoas: @pessoas } %>
				</div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  jQuery(document).ready(function($) {
		$("#botao-filtrar").click(function(event) {
			var nome = $("#nome").val();
			var tipo = $("#tipo").val();
			var cliente = $("#cliente").val();
			var funcionario = $("#funcionario").val();
			$(".loading").show();

			$.ajax({
				url: '<%= casein_pessoa_filtro_ajax_path(1) %>',
				type: 'GET',
				dataType: 'script',
				data: {
					nome: nome,
					tipo: tipo,
					cliente: cliente,
					funcionario: funcionario,
				}
			})
			.done(function() {
				$(".loading").show();
			})
			.fail(function() {

			})
			.always(function() {
				$(".loading").hide();
			});
		});
	});
</script>