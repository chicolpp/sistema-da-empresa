<legend>Filtros</legend>

<div class="form-group">
	<%= label_tag :access_level, "Tipo de Usuário", class: "control-label" %>
	<%= select_tag :access_level, options_for_select([["Administrador", 0], ["Vendedor", 10], ["Funcionario/Revendedor", 11], ["Relatório", 12]], params[:tipo]), include_blank: "Mostrar Todos", class: "form-control" %>
</div>

<button type="button" id="botao-filtrar" class="btn btn-primary" data-toggle="modal" data-target="#filtro">
  Filtrar
</button>

<!-- Modal -->
<div class="modal fade" id="filtro" tabindex="-1" role="dialog" aria-labelledby="filtroLabel">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="filtroLabel">Filtro de Usuário</h4>
      </div>
      <div class="modal-body">
      	<div class="tabela">
	      	<% @admin_users = Casein::AdminUser.all %>
		      <%= render partial: "table", locals: { users: @admin_users} %>
				</div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  jQuery(document).ready(function($) {
		$("#botao-filtrar").click(function(event) {
			var access_level = $("#access_level").val();
			$(".loading").show();

			$.ajax({
				url: '<%= casein_admin_user_filtro_ajax_path(1) %>',
				type: 'GET',
				dataType: 'script',
				data: {
					access_level: access_level,
				}
			})
			.done(function() {
				$(".loading").show();
			})
			.fail(function() {

			})
			.always(function() {
				$(".loading").hide();
			});
		});
	});
</script>